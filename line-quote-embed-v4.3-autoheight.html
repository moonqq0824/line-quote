<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>æ™¶å…¨è±ï½œç·šä¸Šè©¢åƒ¹ï¼ˆæ›´æ–°ç‰ˆï¼‰</title>
<style>
  :root{ --brand-green:#4A7C2D; --brand-green-2:#7FB241; --text:#333; --muted:#777; --border:#ccc; }
  .embed-wrap{ max-width:900px; margin:0 auto; padding:0 8px; font-family:'Microsoft JhengHei','Noto Sans TC',system-ui,-apple-system,Arial,sans-serif; color:var(--text); }
  .embed-title{ text-align:center; color:var(--brand-green); font-size:22px; margin:0 0 10px; }
  .embed-sub{ text-align:center; color:#666; font-size:14px; margin:0 0 18px; }
  .grid{ display:flex; flex-wrap:wrap; gap:16px; }
  .col{ flex:1 1 360px; position:relative; }
  input,select,textarea{ width:100%; padding:12px; font-size:15px; border:1px solid var(--border); border-radius:8px; box-sizing:border-box; background:#fff; }
  textarea{ min-height:100px; resize:vertical; }
  .col label{ position:absolute; left:10px; top:10px; padding:0 6px; background:#fff; color:var(--muted); font-size:14px; pointer-events:none; transition:all .18s ease; }
  .col input:focus + label, .col input:not(:placeholder-shown) + label,
  .col select:focus + label, .col select:not([value=""]) + label,
  .col textarea:focus + label, .col textarea:not(:placeholder-shown) + label{ top:-9px; left:8px; font-size:12px; color:var(--brand-green); }
  .help{ font-size:12px; color:#888; margin:6px 0 0 2px; }
  .tip{ margin-top:10px; font-size:13px; color:#555; background:#f6f7f8; border:1px dashed #cfd4d8; padding:10px 12px; border-radius:8px; }
  .actions{ display:flex; flex-wrap:wrap; gap:10px; margin-top:12px; }
  .btn{ appearance:none; border:0; border-radius:10px; padding:12px 16px; font-size:16px; font-weight:700; cursor:pointer; transition:transform .05s ease; flex:1 1 220px; }
  .btn:active{ transform:translateY(1px); }
  .btn-primary{ background:linear-gradient(135deg,var(--brand-green),var(--brand-green-2)); color:#fff; }
  .btn-secondary{ background:#00c300; color:#fff; text-decoration:none; text-align:center; line-height:22px; display:inline-block; border-radius:10px; font-weight:700; }
  .msg{ display:none; margin-top:10px; color:var(--brand-green); font-weight:700; text-align:center; }
  .req{ color:#d22; margin-left:4px; }
  .desktop-help{ display:none; margin-top:12px; border:1px solid #e2e6ea; border-radius:8px; padding:12px; background:#fafbfc; }
  .desktop-help h3{ margin:0 0 8px; font-size:16px; color:#222; }
  .desktop-help .row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
  .desktop-help .link{ padding:10px 12px; background:#fff; border:1px solid #cfd4d8; border-radius:8px; font-weight:700; text-decoration:none; color:#1a1a1a; }
  .desktop-help .box{ width:100%; min-height:120px; padding:10px; border:1px dashed #cfd4d8; border-radius:8px; font-size:14px; box-sizing:border-box; white-space:pre-wrap; background:#fff; }
</style>
</head>
<body>
<div class="embed-wrap" role="form" aria-label="æ™¶å…¨è± ç·šä¸Šè©¢åƒ¹">
  <h2 class="embed-title">æ™¶å…¨è±æœ‰é™å…¬å¸ ç·šä¸Šè©¢åƒ¹</h2>
  <p class="embed-sub">å¡«å¯«å®Œæˆå¾ŒæŒ‰ã€Œè¤‡è£½å…§å®¹ã€â†’ ã€Œç”¨ LINE å‚³é€åˆ°å®˜æ–¹å¸³è™Ÿã€å³å¯ã€‚</p>

  <div class="grid">
    <div class="col">
      <input id="company" placeholder=" " autocomplete="organization" required>
      <label for="company">å…¬å¸åç¨±ï¼ˆä¾‹ï¼šOOOOæœ‰é™å…¬å¸ï¼‰<span class="req">*</span></label>
    </div>
    <div class="col">
      <input id="contact" placeholder=" " autocomplete="name" required>
      <label for="contact">è¯çµ¡äºº<span class="req">*</span></label>
    </div>

    <div class="col">
      <input id="email" type="email" placeholder=" " inputmode="email" autocomplete="email" required>
      <label for="email">Email<span class="req">*</span></label>
      <div class="help">è«‹å¡«å¸¸ç”¨ä¿¡ç®±ï¼Œä¾¿æ–¼å¯„é€æ­£å¼å ±åƒ¹å–®</div>
    </div>
    <div class="col">
      <input id="phone" type="tel" placeholder=" " inputmode="numeric" autocomplete="tel">
      <label for="phone">æ‰‹æ©Ÿï¼ˆè¼¸å…¥æ™‚è‡ªå‹•åŠ  - ï¼‰</label>
      <div class="help">æ ¼å¼ï¼š0912-345-678</div>
    </div>

    <div class="col">
      <input id="companyPhone" type="tel" placeholder=" " autocomplete="tel">
      <label for="companyPhone">å…¬å¸é›»è©±ï¼ˆå¯å«åˆ†æ©Ÿï¼‰</label>
      <div class="help">ä¾‹ï¼š02-1234-5678#123</div>
    </div>

    <div class="col">
      <select id="process" required>
        <option value="">è«‹é¸æ“‡</option>
        <option value="é›»è§£">é›»è§£</option>
        <optgroup label="é›»è‘—ï¼ˆæ³³ï¼‰">
          <option value="é›»è‘—ï¼ˆæ³³ï¼‰-å¹³é»‘">å¹³é»‘</option>
          <option value="é›»è‘—ï¼ˆæ³³ï¼‰-æ¶ˆå…‰é»‘">æ¶ˆå…‰é»‘</option>
          <option value="é›»è‘—ï¼ˆæ³³ï¼‰-å…¶ä»–ç‰¹æ®Šè‰²">å…¶ä»–ç‰¹æ®Šè‰²</option>
        </optgroup>
        <option value="é›»æ¼¿">é›»æ¼¿</option>
      </select>
      <label for="process">éœ€æ±‚å·¥è—<span class="req">*</span></label>
    </div>

    <div class="col">
      <input id="qty" type="number" placeholder=" " inputmode="numeric" min="1">
      <label for="qty">é è¨ˆè£½é€ æ•¸é‡</label>
    </div>
    <div class="col">
      <input id="material" placeholder=" ">
      <label for="material">æè³ªï¼ˆä¾‹ï¼šSUS304 / é‹åˆé‡‘ï¼‰</label>
    </div>

    <div class="col" style="flex:1 1 100%;">
      <textarea id="note" placeholder=" "></textarea>
      <label for="note">å‚™è¨» / å·¥è—ç´°ç¯€éœ€æ±‚</label>
    </div>
  </div>

  <div class="tip">ğŸ“ ç‚ºåŠ é€Ÿå ±åƒ¹ï¼Œè«‹åœ¨ LINE <strong>ä¸€ä½µå‚³é€ 3D åœ–æª”ï¼ˆSolidWorks/STEPï¼‰æˆ–ç”¢å“ç…§ç‰‡</strong>ã€‚</div>

  <div class="actions">
    <button class="btn btn-primary" id="copyBtn" type="button">è¤‡è£½å ±åƒ¹å…§å®¹</button>
    <a class="btn btn-secondary" id="sendLineBtn" href="#" target="_blank" rel="noopener">ç”¨ LINE å‚³é€åˆ°å®˜æ–¹å¸³è™Ÿ</a>
  </div>
  <div class="msg" id="copiedMsg">å·²è¤‡è£½ï¼Œè«‹åœ¨ LINE å°è©±è¦–çª—è²¼ä¸Šä¸¦å‚³é€ã€‚</div>

  <div class="desktop-help" id="desktopHelp">
    <h3>åœ¨é›»è…¦ä¸Šç™¼é€æ–¹å¼</h3>
    <ol style="margin:0 0 10px 16px; padding:0;">
      <li>è«‹å…ˆå®‰è£ä¸¦ç™»å…¥ <strong>LINE é›»è…¦ç‰ˆ</strong>ã€‚</li>
      <li>é»ã€Œé–‹å•Ÿ LINE é›»è…¦ç‰ˆã€ã€‚è‹¥ç„¡åæ‡‰ï¼Œè«‹é»ã€ŒåŠ å¥½å‹ã€ç”¨æ‰‹æ©Ÿæƒæã€‚</li>
    </ol>
    <div class="row">
      <a class="link" id="openApp" href="#">é–‹å•Ÿ LINE é›»è…¦ç‰ˆ</a>
      <a class="link" id="addFriend" href="https://lin.ee/1NWICIL" target="_blank" rel="noopener">åŠ å¥½å‹ï¼ˆå¯é¡¯ç¤º QRï¼‰</a>
    </div>
    <textarea id="deskMsg" class="box" readonly style="margin-top:10px;"></textarea>
  </div>
</div>

<script>
(function(){
  // ã€é—œéµä¿®æ”¹é»ã€‘è«‹å°‡ä¸‹æ–¹çš„ ID æ”¹ç‚ºæ–°å¸³è™Ÿçš„ ID
  const OA_ID = '@889fcgip'; 
  
  const $ = (id)=>document.getElementById(id);
  const company = $('company'), contact = $('contact'), email = $('email');
  const phone = $('phone'), companyPhone = $('companyPhone');
  const process = $('process'), qty = $('qty'), material = $('material'), note = $('note');
  const copyBtn = $('copyBtn'), copiedMsg = $('copiedMsg'), sendLineBtn = $('sendLineBtn');
  const desktopHelp = $('desktopHelp'), openApp = $('openApp'), deskMsg = $('deskMsg');

  const isMobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);

  function formatTWMobile(raw){
    const digits = raw.replace(/\D/g, '').slice(0,10);
    const a = digits.slice(0,4), b = digits.slice(4,7), c = digits.slice(7,10);
    let out = a; if(b) out += '-' + b; if(c) out += '-' + c; return out;
  }
  phone.addEventListener('input', ()=>{ phone.value = formatTWMobile(phone.value); });

  function validate(){
    if(!company.value.trim() || !contact.value.trim() || !email.value.trim() || !process.value){
      alert('è«‹å¡«å¯«æ‰€æœ‰æ¨™ç¤º * çš„å¿…å¡«æ¬„ä½ã€‚'); return false;
    }
    return true;
  }

  function buildText(){
    return [
      'ã€æ™¶å…¨è±è©¢åƒ¹éœ€æ±‚ã€‘',
      'å…¬å¸ï¼š' + company.value.trim(),
      'è¯çµ¡äººï¼š' + contact.value.trim(),
      'Emailï¼š' + email.value.trim(),
      (phone.value.trim() ? ('æ‰‹æ©Ÿï¼š' + phone.value.trim()) : ''),
      (companyPhone.value.trim() ? ('é›»è©±ï¼š' + companyPhone.value.trim()) : ''),
      'éœ€æ±‚å·¥è—ï¼š' + process.value,
      'æ•¸é‡ï¼š' + (qty.value.trim() || 'æœªå¡«'),
      'æè³ªï¼š' + (material.value.trim() || 'æœªå¡«'),
      'å‚™è¨»ï¼š' + (note.value.trim() || 'ç„¡'),
      '---',
      'ï¼ˆè«‹ä¸€ä½µå‚³é€ç”¢å“åœ–æª”ä»¥åˆ©å ±åƒ¹ï¼‰'
    ].filter(Boolean).join('\n');
  }

  copyBtn.addEventListener('click', ()=>{
    if(!validate()) return;
    const text = buildText();
    navigator.clipboard.writeText(text).then(()=>{
      copiedMsg.style.display='block';
      setTimeout(()=>{ copiedMsg.style.display='none'; }, 2000);
    });
  });

  sendLineBtn.addEventListener('click', (e)=>{
    if(!validate()){ e.preventDefault(); return; }
    const text = buildText();
    if(isMobile){
      // æ‰‹æ©Ÿç‰ˆè‡ªå‹•å¸¶å…¥æ–‡å­—é€£çµ
      const url = 'https://line.me/R/oaMessage/' + encodeURIComponent(OA_ID) + '/?' + encodeURIComponent(text);
      sendLineBtn.setAttribute('href', url);
    } else {
      e.preventDefault();
      const appUrl = 'line://oaMessage/' + encodeURIComponent(OA_ID) + '/?' + encodeURIComponent(text);
      desktopHelp.style.display = 'block';
      deskMsg.value = text;
      openApp.setAttribute('href', appUrl);
      window.location.href = appUrl;
    }
  });

  function sendHeight(){
    try{
      const h = document.documentElement.scrollHeight || document.body.scrollHeight;
      window.parent.postMessage({ type: 'setHeight', height: h }, '*');
    }catch(e){}
  }
  window.addEventListener('load', sendHeight);
  window.addEventListener('resize', sendHeight);
  new MutationObserver(sendHeight).observe(document.body, { childList:true, subtree:true, attributes:true });
})();
</script>
</body>
</html>
